<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>원격 CVE 취약점 스캐너</title>
    <link rel="icon" type="image/jpeg" href="/static/images/logo.jpg">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="/static/css/dashboard.css" rel="stylesheet">
    <style>
        .host-item {
            transition: background-color 0.1s;
            border-left: 3px solid transparent;
        }

        .host-item:hover {
            background-color: rgba(0, 0, 0, 0.03);
            border-left-color: #0d6efd;
        }

        .host-item:active {
            background-color: rgba(0, 0, 0, 0.08);
        }

        .host-item.active {
            background-color: #e7f1ff;
            border-left-color: #0d6efd;
        }

        .job-row {
            cursor: pointer;
            transition: background-color 0.15s;
        }

        .job-row:hover {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .job-row.selected {
            background-color: #fff3cd;
        }

        .finding-row {
            cursor: pointer;
            transition: background-color 0.1s;
        }

        .finding-row:hover {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .sortable {
            cursor: pointer;
            user-select: none;
        }

        .sortable:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .sort-icon {
            font-size: 0.75rem;
            margin-left: 4px;
            opacity: 0.3;
            transition: opacity 0.2s;
        }

        .sort-icon.active {
            opacity: 1;
            color: #0d6efd;
        }

        .stats-card {
            border-left: 4px solid;
        }

        .stats-card.danger {
            border-left-color: #dc3545;
        }

        .stats-card.warning {
            border-left-color: #ffc107;
        }

        .stats-card.primary {
            border-left-color: #0d6efd;
        }

        .stats-card.info {
            border-left-color: #0dcaf0;
        }

        .stats-card.success {
            border-left-color: #198754;
        }

        /* Custom Range Slider Styling */
        .custom-range {
            height: 6px;
            background: #495057;
            border-radius: 3px;
            outline: none;
        }

        .custom-range::-webkit-slider-thumb {
            width: 18px;
            height: 18px;
            background: #0d6efd;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .custom-range::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: #0d6efd;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .custom-range::-webkit-slider-runnable-track {
            height: 6px;
            background: #495057;
            border-radius: 3px;
        }

        .custom-range::-moz-range-track {
            height: 6px;
            background: #495057;
            border-radius: 3px;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <header class="py-3 mb-4 border-bottom">
            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center gap-3">
                    <img src="/static/images/logo.jpg" alt="Logo" style="height: 50px;">
                    <div>
                        <h1 class="h4 mb-0 fw-bold">
                            원격 CVE 취약점 스캐너
                        </h1>
                        <p class="small text-muted mb-0">Remote Vulnerability Scanner</p>
                    </div>
                </div>
            </div>
        </header>

        <div class="row">
            <!-- 좌측: 호스트 목록 및 스캔 설정 -->
            <div class="col-md-3">
                <!-- 호스트 목록 -->
                <div class="card mb-3 shadow-sm">
                    <div
                        class="card-header bg-primary text-white py-2 d-flex justify-content-between align-items-center">
                        <span>

                            <strong>원격 호스트</strong>
                            <span class="badge bg-light text-primary ms-2" id="hostCount">0</span>
                        </span>
                        <button class="btn btn-light btn-sm" onclick="showAddHostModal()">
                            +
                        </button>
                    </div>
                    <div class="list-group list-group-flush" id="remoteHostsList"
                        style="max-height: 400px; overflow-y: auto;">
                        <div class="text-center text-muted py-5">

                            <p class="small">등록된 호스트가 없습니다</p>
                        </div>
                    </div>
                </div>

                <!-- 스캔 옵션 -->
                <div class="card shadow-sm mb-3" id="scanOptions" style="display: none;">
                    <div class="card-header py-2">
                        <strong>스캔 옵션</strong>
                    </div>
                    <div class="card-body py-2">
                        <div class="mb-2">
                            <label for="cveYearStart" class="form-label small mb-1">
                                CVE 검색 기간:
                                <strong id="cveYearRange" class="text-primary">1999 ~ 2026</strong>
                            </label>
                            <input type="range" class="form-range custom-range" id="cveYearStart" min="1999" max="2026"
                                value="1999" step="1">
                            <div class="d-flex justify-content-between small text-muted mt-1">
                                <span>1999</span>
                                <span>현재(2026)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- NVD 데이터 다운로드 -->
                <div class="card shadow-sm">
                    <div class="card-header py-2">
                        <i class="bi bi-cloud-download me-1"></i><strong>NVD 데이터 관리</strong>
                    </div>
                    <div class="card-body py-2">
                        <div class="mb-2">
                            <label for="nvdDownloadYear" class="form-label small mb-1">
                                년도 범위 다운로드
                            </label>
                            <div class="row g-2 mb-2">
                                <div class="col-6">
                                    <select class="form-select form-select-sm" id="nvdStartYear">
                                        <option value="2026">2026년</option>
                                        <option value="2025">2025년</option>
                                        <option value="2024">2024년</option>
                                        <option value="2023">2023년</option>
                                        <option value="2022">2022년</option>
                                        <option value="2021">2021년</option>
                                        <option value="2020" selected>2020년</option>
                                        <option value="2019">2019년</option>
                                        <option value="2018">2018년</option>
                                        <option value="2017">2017년</option>
                                        <option value="2016">2016년</option>
                                        <option value="2015">2015년</option>
                                        <option value="2010">2010년</option>
                                        <option value="2005">2005년</option>
                                        <option value="2000">2000년</option>
                                        <option value="1999">1999년</option>
                                    </select>
                                </div>
                                <div class="col-6">
                                    <select class="form-select form-select-sm" id="nvdEndYear">
                                        <option value="2026" selected>2026년</option>
                                        <option value="2025">2025년</option>
                                        <option value="2024">2024년</option>
                                        <option value="2023">2023년</option>
                                        <option value="2022">2022년</option>
                                        <option value="2021">2021년</option>
                                        <option value="2020">2020년</option>
                                    </select>
                                </div>
                            </div>
                            <div class="d-grid">
                                <button class="btn btn-sm btn-outline-primary" id="downloadNvdBtn"
                                    onclick="downloadNvdRange()">
                                    선택 범위 다운로드
                                </button>
                            </div>
                            <div id="nvdDownloadProgress" class="mt-2" style="display: none;">
                                <div class="progress" style="height: 20px;">
                                    <div id="nvdProgressBar"
                                        class="progress-bar progress-bar-striped progress-bar-animated bg-primary"
                                        role="progressbar" style="width: 0%">
                                        <span id="nvdProgressText">다운로드 중...</span>
                                    </div>
                                </div>
                                <small class="text-muted d-block mt-1" id="nvdProgressDetail">준비 중...</small>
                            </div>
                        </div>
                        <div class="d-grid mt-2">
                            <button class="btn btn-sm btn-outline-secondary" onclick="showNvdManager()">
                                <i class="bi bi-gear me-1"></i>다운로드 기록 관리
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 선택된 호스트 정보 -->
                <div class="card shadow-sm" id="selectedHostInfo" style="display: none;">
                    <div class="card-header py-2">
                        <strong>호스트 정보</strong>
                    </div>
                    <div class="card-body py-2 small" id="selectedHostDetails">
                    </div>
                </div>
            </div>

            <!-- 중앙/우측: 스캔 현황 및 결과 -->
            <div class="col-md-9">
                <!-- 스캔 작업 현황 -->
                <div class="card mb-3 shadow-sm">
                    <div class="card-header py-2 d-flex justify-content-between align-items-center">
                        <span><strong>스캔 작업 현황</strong></span>
                        <small class="text-muted">작업 클릭 시 해당 결과 표시</small>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive" style="max-height: 250px; overflow-y: auto;">
                            <table class="table table-sm table-hover mb-0">
                                <thead class="table-light sticky-top">
                                    <tr>
                                        <th style="width: 150px;">호스트</th>
                                        <th style="width: 80px;">상태</th>
                                        <th>단계</th>
                                        <th style="width: 100px;">진행률</th>
                                        <th style="width: 120px;">시작</th>
                                        <th style="width: 80px;">소요</th>
                                        <th style="width: 80px;">결과</th>
                                    </tr>
                                </thead>
                                <tbody id="remoteJobsBody">
                                    <tr>
                                        <td colspan="7" class="text-center text-muted py-4">스캔 작업이 없습니다</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- 대시보드 통계 -->
                <div class="row mb-3" id="dashboardStats" style="display: none;">
                    <div class="col-md-3">
                        <div class="card stats-card danger shadow-sm">
                            <div class="card-body py-2 text-center">
                                <h3 class="mb-0 text-danger" id="highCount">-</h3>
                                <small class="text-muted">High (7.0~10.0)</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card stats-card warning shadow-sm">
                            <div class="card-body py-2 text-center">
                                <h3 class="mb-0 text-warning" id="mediumCount">-</h3>
                                <small class="text-muted">Medium (4.0~6.9)</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card stats-card primary shadow-sm">
                            <div class="card-body py-2 text-center">
                                <h3 class="mb-0 text-primary" id="lowCount">-</h3>
                                <small class="text-muted">Low (0.1~3.9)</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card stats-card success shadow-sm">
                            <div class="card-body py-2 text-center">
                                <h3 class="mb-0" id="totalCves">-</h3>
                                <small class="text-muted">전체 CVE</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 취약점 목록 -->
                <div class="card shadow-sm">
                    <div class="card-header py-2 d-flex justify-content-between align-items-center">
                        <span>
                            <strong>발견된 취약점</strong>
                            <span class="badge bg-secondary ms-2" id="findingsCount">0</span>
                        </span>
                        <div class="d-flex gap-2 align-items-center">
                            <!-- CVSS 점수 필터 버튼 그룹 -->
                            <div class="btn-group btn-group-sm" role="group" aria-label="CVSS 점수 필터">
                                <button type="button" class="btn btn-outline-danger cvss-filter-btn" data-cvss="HIGH"
                                    onclick="toggleCvssFilter('HIGH')" title="High (7.0~10.0)">
                                    HIGH
                                </button>
                                <button type="button" class="btn btn-outline-warning cvss-filter-btn" data-cvss="MED"
                                    onclick="toggleCvssFilter('MED')" title="Medium (4.0~6.9)">
                                    MED
                                </button>
                                <button type="button" class="btn btn-outline-primary cvss-filter-btn" data-cvss="LOW"
                                    onclick="toggleCvssFilter('LOW')" title="Low (0.1~3.9)">
                                    LOW
                                </button>
                            </div>
                            <!-- 수집방식 필터 버튼 그룹 -->
                            <div class="btn-group btn-group-sm" role="group" aria-label="수집방식 필터">
                                <button type="button" class="btn btn-outline-secondary collector-filter-btn active"
                                    data-mode="all" onclick="setCollectorFilter(null)" title="전체 보기">
                                    ALL
                                </button>
                                <button type="button" class="btn btn-outline-danger collector-filter-btn" data-mode="os"
                                    onclick="setCollectorFilter('os')" title="OS 패키지 CVE">
                                    OS
                                </button>
                                <button type="button" class="btn btn-outline-warning collector-filter-btn"
                                    data-mode="kernel" onclick="setCollectorFilter('kernel')" title="커널 CVE">
                                    KRN
                                </button>
                                <button type="button" class="btn btn-outline-success collector-filter-btn"
                                    data-mode="local" onclick="setCollectorFilter('local')" title="로컬 스캔 CVE">
                                    LOC
                                </button>
                            </div>
                            <button class="btn btn-sm btn-outline-danger" id="scanPocBtn" disabled
                                onclick="scanAllPoCs()">
                                PoC 스캔
                            </button>
                            <button class="btn btn-sm btn-outline-primary" id="scanHistoryBtn"
                                onclick="showScanHistory()">
                                히스토리
                            </button>
                            <button class="btn btn-sm btn-outline-primary" id="viewSbomBtn" disabled
                                onclick="showSbomViewer()">
                                SBOM
                            </button>
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive" style="max-height: 500px; overflow-y: auto;">
                            <table class="table table-sm table-hover mb-0 findings-table">
                                <thead class="table-light sticky-top">
                                    <tr>
                                        <th class="sortable" data-sort="package_name">
                                            패키지<span class="sort-icon"><i class="bi bi-chevron-down"></i></span>
                                        </th>
                                        <th style="width: 100px;">버전</th>
                                        <th class="sortable" data-sort="cve_id" style="width: 130px;">
                                            CVE ID<span class="sort-icon"><i class="bi bi-chevron-down"></i></span>
                                        </th>
                                        <th class="sortable" data-sort="cvss" style="width: 100px;">
                                            CVSS<span class="sort-icon active"><i class="bi bi-chevron-down"></i></span>
                                        </th>
                                        <th class="sortable" data-sort="epss" style="width: 90px;">
                                            EPSS<span class="sort-icon"><i class="bi bi-chevron-down"></i></span>
                                        </th>
                                        <th class="sortable" data-sort="kev" style="width: 70px;">
                                            KEV<span class="sort-icon"><i class="bi bi-chevron-down"></i></span>
                                        </th>
                                        <th class="sortable" data-sort="poc" style="width: 80px;">
                                            PoC<span class="sort-icon"><i class="bi bi-chevron-down"></i></span>
                                        </th>
                                        <th style="width: 100px;">수집방식</th>
                                        <th class="sortable" data-sort="running" style="width: 100px;">
                                            실행상태<span class="sort-icon"><i class="bi bi-chevron-down"></i></span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="findingsBody">
                                    <tr>
                                        <td colspan="9" class="text-center text-muted py-5">

                                            <p>호스트를 선택하거나 스캔 작업 결과를 클릭하세요</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 호스트 추가/편집 모달 -->
    <div class="modal fade" id="hostModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="hostModalTitle">
                        <i class="bi bi-plus-circle me-1"></i>호스트 등록
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="hostForm">
                        <input type="hidden" id="hostId">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label small fw-bold">호스트명 <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="hostHostname" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label small fw-bold">IP 주소 <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="hostIpAddress" required>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label class="form-label small">SSH 포트</label>
                                <input type="number" class="form-control" id="hostSshPort" value="22">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label small">사용자명</label>
                                <input type="text" class="form-control" id="hostSshUsername" value="root">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label small">인증방식</label>
                                <select class="form-select" id="hostAuthMethod" onchange="toggleAuthMethod()">
                                    <option value="key">SSH 키</option>
                                    <option value="password">비밀번호</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3" id="sshKeyGroup">
                            <label class="form-label small">SSH 키 경로</label>
                            <input type="text" class="form-control" id="hostSshKeyPath" placeholder="~/.ssh/id_rsa">
                            <div class="form-text">비어있으면 기본 SSH 키 사용</div>
                        </div>
                        <div class="mb-3" id="sshPasswordGroup" style="display:none;">
                            <label class="form-label small">SSH 비밀번호</label>
                            <input type="password" class="form-control" id="hostSshPassword">
                            <div class="form-text">sshpass를 사용하여 비밀번호 인증</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label small">태그</label>
                            <input type="text" class="form-control" id="hostTags"
                                placeholder="예: production, alpine, arm">
                        </div>
                        <div class="mb-3">
                            <label class="form-label small">설명</label>
                            <textarea class="form-control" id="hostDescription" rows="2"></textarea>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="hostIsAllowed" checked>
                            <label class="form-check-label" for="hostIsAllowed">
                                스캔 허용 (Allowlist)
                                <small class="text-muted d-block">체크 해제 시 스캔 불가</small>
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-danger me-auto" id="hostDeleteBtn"
                        style="display:none;" onclick="deleteHost()">
                        <i class="bi bi-trash"></i> 삭제
                    </button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" onclick="saveHost()">
                        <i class="bi bi-save"></i> 저장
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- CVE 상세 모달 -->
    <div class="modal fade" id="cveDetailModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="cveDetailTitle">CVE 상세 정보</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="cveDetailBody">
                    <div class="text-center py-4">
                        <div class="spinner-border"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SBOM Viewer 모달 -->
    <div class="modal fade" id="sbomModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-secondary text-white">
                    <h5 class="modal-title">
                        SBOM (Software Bill of Materials)
                    </h5>
                    <button class="btn btn-sm btn-light ms-auto" onclick="downloadSbom()">
                        JSON 다운로드
                    </button>
                    <button type="button" class="btn-close btn-close-white ms-2" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="sbomBody">
                    <div class="text-center py-4">
                        <div class="spinner-border"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline-secondary" onclick="downloadSbom()">
                        SBOM JSON 다운로드
                    </button>
                    <button class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3"></div>

    <!-- NVD 데이터 관리 모달 -->
    <div class="modal fade" id="nvdManagerModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        NVD 다운로드 기록 관리
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table table-sm table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th>년도</th>
                                    <th>CVE 개수</th>
                                    <th>패키지 수</th>
                                    <th>용량</th>
                                    <th>다운로드 시간</th>
                                    <th>작업</th>
                                </tr>
                            </thead>
                            <tbody id="nvdRecordsTable">
                                <tr>
                                    <td colspan="6" class="text-center text-muted">
                                        <i class="bi bi-hourglass-split me-1"></i>로딩 중...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="alert alert-info small mb-0">

                        <strong>안내:</strong> 년도별 데이터를 삭제하면 해당 년도의 모든 CVE 캐시가 제거됩니다.
                        다시 다운로드하려면 "년도 범위 다운로드" 기능을 사용하세요.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-secondary" data-bs-dismiss="modal">닫기</button>
                    <button type="button" class="btn btn-sm btn-primary" onclick="loadNvdRecords()">
                        <i class="bi bi-arrow-clockwise me-1"></i>새로고침
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- PoC/Exploit 모달 -->
    <div class="modal fade" id="pocModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-warning text-dark">
                    <h5 class="modal-title">
                        <i class="bi bi-bug me-2"></i>Exploit/PoC 검색 결과
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="pocContent">
                        <div class="text-center py-4">
                            <span class="spinner-border spinner-border-sm"></span> PoC 정보 조회 중...
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 스캔 히스토리 모달 -->
    <div class="modal fade" id="scanHistoryModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-secondary text-white">
                    <h5 class="modal-title">
                        스캔 히스토리
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info small mb-3">

                        두 스캔을 선택하여 비교하면 <strong>신규/해결/유지</strong> 취약점을 확인할 수 있습니다.
                    </div>
                    <div class="table-responsive">
                        <table class="table table-sm table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th style="width: 40px;">
                                        <input type="checkbox" id="selectAllScans" disabled title="전체 선택 불가">
                                    </th>
                                    <th>스캔 시작</th>
                                    <th>상태</th>
                                    <th>패키지</th>
                                    <th>CVE</th>
                                    <th>고위험</th>
                                    <th>작업</th>
                                </tr>
                            </thead>
                            <tbody id="scanHistoryBody">
                                <tr>
                                    <td colspan="7" class="text-center text-muted py-4">
                                        <i class="bi bi-hourglass-split me-1"></i>로딩 중...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <span class="me-auto text-muted small" id="scanSelectionInfo">0개 선택됨</span>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                    <button type="button" class="btn btn-primary" id="compareScansBtn" disabled
                        onclick="compareSelectedScans()">
                        <i class="bi bi-arrow-left-right me-1"></i>선택한 스캔 비교
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 스캔 비교 결과 모달 -->
    <div class="modal fade" id="scanCompareModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">
                        <i class="bi bi-arrow-left-right me-2"></i>스캔 결과 비교
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="scanCompareContent">
                    <div class="text-center py-4">
                        <span class="spinner-border spinner-border-sm"></span> 비교 중...
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                    <button type="button" class="btn btn-outline-primary" onclick="exportCompareResult()">
                        비교 결과 CSV
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/remote-ui.js"></script>
</body>

</html>